if (self.CavalryLogger) { CavalryLogger.start_js(["5nPpm"]); }

__d("ChatSidebarRecentCallsStore",["ChatDispatcher","ChatSidebarRecentCallsActions","FluxReduceStore","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;g=babelHelpers.inherits(i,b("immutable").Record({calls:b("immutable").List()}));g&&g.prototype;function i(){g.apply(this,arguments)}c=babelHelpers.inherits(a,b("FluxReduceStore"));h=c&&c.prototype;function a(a){h.constructor.call(this,a)}a.prototype.getInitialState=function(){return new i()};a.prototype.getParticipants=function(){var a=[];this.getState().calls.forEach(function(b){b=b.participants;a.push.apply(a,b)});return a};a.prototype.reduce=function(a,c){switch(c.type){case b("ChatSidebarRecentCallsActions").RECENT_CALLS_UPDATED:return a.set("calls",b("immutable").List(c.calls));default:return a}};a.__moduleID=e.id;e.exports=new a(b("ChatDispatcher"))}),null);
__d("FluxDerivedStore",["FluxStore","UserTimingUtils","abstractMethod","gkx","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("gkx")("779516");c=babelHelpers.inherits(a,b("FluxStore"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),h||(this.$FluxDerivedStore3=this.__getStores(),this.$FluxDerivedStore4=this.$FluxDerivedStore3.map(function(a){return a.getDispatchToken()})),this.$FluxDerivedStore1=b("immutable").Map(),this.$FluxDerivedStore2=new Map()}a.prototype.__getActionTypes=function(){return h?[]:null};a.prototype.__onDispatch=function(a){__p&&__p();if(h){if(!this.$FluxDerivedStore2)return;this.getDispatcher().waitFor(this.getDependencyDispatchTokens());this.getDependencyStores().some(function(a){return a.hasChanged()})&&(this.$FluxDerivedStore2.clear(),this.__emitChange())}else{if(!this.$FluxDerivedStore3)return;this.getDispatcher().waitFor(this.$FluxDerivedStore4);this.$FluxDerivedStore3.some(function(a){return a.hasChanged()})&&(this.$FluxDerivedStore2.clear(),this.__emitChange())}};a.prototype.__getStores=function(){return b("abstractMethod")(this.constructor.name,"__getStores")};a.prototype.__getData=function(a,c){return b("abstractMethod")(this.constructor.name,"__getData")};a.prototype.__getCachedData=function(a,c){return b("abstractMethod")(this.constructor.name,"__getCachedData")};a.prototype.__computeResult=function(a,c,d){return b("abstractMethod")(this.constructor.name,"__computeResult")};a.prototype.__areEqual=function(a,b){return a===b};a.prototype.__updateOne=function(a,b,c,d){if(!d||!this.__areEqual(d,c)){d=this.__computeResult(b,c,this.$FluxDerivedStore1.getIn([b,"result"],null));a.setIn([b,"data"],c);a.setIn([b,"result"],d)}};a.prototype.__updateAll=function(a,b,c,d){__p&&__p();for(var b=b,e=Array.isArray(b),f=0,b=e?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;this.__updateOne(a,g,c.get(g),d.get(g))}};a.prototype.get=function(a){if(this.$FluxDerivedStore2.get(a))return this.$FluxDerivedStore1.getIn([a,"result"]);var b=this.$FluxDerivedStore1.getIn([a,"data"]),c=this.__getData(a,b);this.$FluxDerivedStore1=this.$FluxDerivedStore1.withMutations(function(d){return this.__updateOne(d,a,c,b)}.bind(this));this.$FluxDerivedStore2.set(a,!0);return this.$FluxDerivedStore1.getIn([a,"result"])};a.prototype.getCached=function(a){if(this.$FluxDerivedStore2.get(a))return this.$FluxDerivedStore1.getIn([a,"result"]);var b=this.$FluxDerivedStore1.getIn([a,"data"]),c=this.__getCachedData(a,b);this.$FluxDerivedStore1=this.$FluxDerivedStore1.withMutations(function(d){return this.__updateOne(d,a,c,b)}.bind(this));return this.$FluxDerivedStore1.getIn([a,"result"])};a.prototype.getAll=function(a,c){__p&&__p();var d=new Set(a),e=c||this.$FluxDerivedStore5||b("immutable").Map();c=e.withMutations(function(b){__p&&__p();e.forEach(function(a,c){d.has(c)||b["delete"](c)});if(this.__getDataAll){var c=this.$FluxDerivedStore1.filter(function(a,b){return d.has(b)}).map(function(a){return a.get("data")}),f=this.__getDataAll(d,c);this.$FluxDerivedStore1=this.$FluxDerivedStore1.withMutations(function(b){return this.__updateAll(b,a,f,c)}.bind(this));d.forEach(function(a){b.set(a,this.$FluxDerivedStore1.getIn([a,"result"]))}.bind(this))}else d.forEach(function(a){b.set(a,this.get(a))}.bind(this))}.bind(this));this.$FluxDerivedStore5=c;return c};a.prototype.getAllCached=function(a,c){__p&&__p();var d=new Set(a),e=c||this.$FluxDerivedStore5||b("immutable").Map();a=e.withMutations(function(a){__p&&__p();for(var b=e.keys(),c=Array.isArray(b),f=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(c){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;d.has(g)||a["delete"](g)}this.$FluxDerivedStore1=this.$FluxDerivedStore1.withMutations(function(b){__p&&__p();for(var c=d,e=Array.isArray(c),f=0,c=e?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=c.length)break;g=c[f++]}else{f=c.next();if(f.done)break;g=f.value}g=g;var h=b.getIn([g,"data"]),i=this.__getCachedData(g,h);this.__updateOne(b,g,i,h);a.set(g,b.getIn([g,"result"]))}}.bind(this))}.bind(this));this.$FluxDerivedStore5=a;return a};a.prototype.clearCacheForTestsOnly=function(){this.$FluxDerivedStore2.clear()};a.prototype.__getDependencyStores=function(){return this.__getStores()};a.__moduleID=e.id;e.exports=a}),null);
__d("ChatSidebarDerivedStore",["ChatDispatcher","ChatSidebarPresencePrivacyActions","ChatSidebarPresencePrivacyStore","ChatSidebarRecentCallsStore","ChatSidebarStore","ChatSidebarUserDetailsFactory","ChatUnreadCountStore","FluxDerivedStore","PresencePrivacy","PresenceStatusStore","ShortProfilesStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("FluxDerivedStore"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.$ChatSidebarDerivedStore1()}a.prototype.$ChatSidebarDerivedStore1=function(){b("PresencePrivacy").subscribe("privacy-user-presence-changed",function(){b("ChatDispatcher").dispatch({type:b("ChatSidebarPresencePrivacyActions").USER_PRESENCE_CHANGED})}),b("PresencePrivacy").subscribe("privacy-changed",function(){b("ChatDispatcher").dispatch({type:b("ChatSidebarPresencePrivacyActions").PRIVACY_CHANGED})}),b("PresencePrivacy").subscribe("privacy-availability-changed",function(){b("ChatDispatcher").dispatch({type:b("ChatSidebarPresencePrivacyActions").PRIVACY_CHANGED})}),b("PresencePrivacy").subscribe("privacy-user-presence-response",function(){b("ChatDispatcher").dispatch({type:b("ChatSidebarPresencePrivacyActions").USER_PRESENCE_CHANGED})})};a.prototype.__getStores=function(){return[b("ChatSidebarPresencePrivacyStore"),b("ChatSidebarRecentCallsStore"),b("ChatSidebarStore"),b("ChatUnreadCountStore"),b("PresenceStatusStore"),b("ShortProfilesStore")]};a.prototype.__getData=function(a){var c=b("ChatSidebarStore").getExtraData(a),d=b("ChatSidebarStore").getUsersData(c.numTopFriends),e=b("ChatSidebarStore").getState(),f=d.availableUsers,g=d.offlineUsers,h=d.topUsers,i=d.workOthers,j=c.nearby,k=e.isAfterDomLoad,l=b("ChatSidebarRecentCallsStore").getState(),m=b("ChatSidebarRecentCallsStore").getParticipants();return babelHelpers["extends"]({},e,c,d,{maxItemSlots:a,presencePrivacy:b("ChatSidebarPresencePrivacyStore").getState(),recentCalls:l,usersDetailedData:b("ChatSidebarUserDetailsFactory").getUsersDetailedData([].concat(f,j,g,m,h,i),k)})};a.prototype.__computeResult=function(a,c){a=c.presencePrivacy.currentUser;return babelHelpers["extends"]({},c,{isUserOffline:a===b("PresencePrivacy").OFFLINE})};a.prototype.getVisibleType=function(){return b("ChatSidebarStore").getVisibleType()};a.__moduleID=e.id;e.exports=new a(b("ChatDispatcher"))}),null);
__d("BaseChatSidebar.react",["Arbiter","AsyncRequest","Bootloader","ChatConfig","ChatDispatcher","ChatSidebarActions","ChatSidebarCachedViewport","ChatSidebarConstants","ChatSidebarDerivedStore","ChatSidebarVisibility","CSS","DOM","Event","LitestandClassicPlaceHolders","MessengerDivebarSizingTypedLogger","PresencePrivacy","PresenceUtil","React","SidebarAppsInitialVisibility","SidebarType","Style","URI","ViewportBounds","debounceAcrossTransitions","emptyFunction","gkx","ifRequired","onAfterDisplay","onAfterLoadSafe","queryThenMutateDOM","requireWeak"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=44,i=b("ChatSidebarConstants").getItemHeight(),j=8,k="sidebarMode",l=b("ChatConfig").get("expanded_divebar_width"),m=171,n=30,o=300,p=b("ChatConfig").get("sidebar.hide_buddylist_off_homepage"),q="buddylistOff",r=b("ChatSidebarCachedViewport").viewport;function s(a){new(b("AsyncRequest"))("/ajax/chat/settings.php").setHandler(b("emptyFunction")).setErrorHandler(b("emptyFunction")).setData({sidebar_mode:a,window_id:b("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(!0).send()}a=babelHelpers.inherits(t,b("React").Component);g=a&&a.prototype;function t(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$2=!1,this.$3=!0,this.$4=b("emptyFunction"),this.$5=b("emptyFunction"),this.state={computedState:b("ChatSidebarDerivedStore").get(t.calculateMaxItemSlots(this.props.heightOffset)),show:!0,pinnedThreads:[]},this.handleDerivedStoreChange=function(){var a=b("ChatSidebarDerivedStore").get(t.calculateMaxItemSlots(this.props.heightOffset));a!==this.state.computedState&&this.setState({computedState:a})}.bind(this),this.handleMouserOut=function(){this.$2=!1,this.$3&&(this.$3=!1,this.$4())}.bind(this),this.handleMouserOver=function(){this.$2=!0}.bind(this),this.handleMouseEnterItem=function(a){b("Bootloader").loadModules(["ChatSidebarHoverCardV2"],function(b){var c=this.state.computedState,d=c.adminedPages.map(function(a){return a.id+""}).filter(Boolean);b.prefetchHoverCardData(a,c.availableUsers.concat(d,c.nearby,c.topUsers,c.workOthers))}.bind(this),"BaseChatSidebar.react")}.bind(this),this.resize=function(a,c){var d,e;b("queryThenMutateDOM")(function(){c&&c(),e=r||{},(!a||a.height!==e.height)&&(d=t.getBodyHeight(this.props.heightOffset))}.bind(this),function(){(!a||a.width!==e.width)&&b("ChatSidebarVisibility").shouldShowSidebar(r,function(a,c){b("ChatSidebarActions").show(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)}),this.adjustToFitHeightFromParams(d)}.bind(this))}.bind(this),this.updateOnActiveTypeahead=function(a,b){this.setState({show:!b})}.bind(this),this.update=function(a){if(!this.shouldSidebarUpdate())return;a?this.handleSizeUpdate():this.handleUsersUpdate()}.bind(this),c}t.calculateMaxItemSlots=function(a){return Math.floor((t.getBodyHeight(a)-j)/i)};t.getBodyHeight=function(a){var c=r||b("ChatSidebarVisibility").getViewport(),d=c.height;d-=h;d-=n;d-=a;b("ifRequired")("AppsDivebarDisplayController",function(a){a.isVisible()&&(d-=m)},function(){b("SidebarAppsInitialVisibility").visible&&(d-=m)});return Math.max(0,d)};t.prototype.componentDidMount=function(){__p&&__p();this.$4=b("debounceAcrossTransitions")(this.update,o,this);this.$5=b("debounceAcrossTransitions")(this.handleDerivedStoreChange,o,this);this.setupStore();this.setupSearchHandler();this.setupSettingHandler();b("Event").listen(window,"resize",function(){var a=babelHelpers["extends"]({},r)||{};this.resizeAndUpdateViewport(a)}.bind(this));b("Arbiter").subscribe("page_transition",function(a,c){b("ChatSidebarVisibility").shouldShowSidebar(r,function(a,d){d=document.documentElement||"";p&&c.uri.getPath()!=="/"?b("CSS").addClass(d,q):(b("CSS").removeClass(d,q),p&&b("Bootloader").loadModules(["Dock"],function(a){a.resizeAllFlyouts()},"BaseChatSidebar.react"));b("ChatSidebarActions").show(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)},c.uri)});b("PresencePrivacy").subscribe("privacy-user-presence-changed",this.resize);this.$1=b("DOM").find(this.props.root,"div.fbChatSidebarBody");var a=t.getBodyHeight(this.props.heightOffset);b("Style").set(this.$1,"height",a+"px");b("onAfterLoadSafe")(function(){__p&&__p();var a=this.state.computedState.visible===b("SidebarType").SIDEBAR;this.resizeAndUpdateViewport();b("onAfterLoadSafe")(function(){a!==(this.state.computedState.visible===b("SidebarType").SIDEBAR)&&b("Bootloader").loadModules(["ChatReliabilityInstrumentation"],function(a){a.logERROR("sidebar flashed")},"BaseChatSidebar.react")}.bind(this));b("Bootloader").loadModules(["AvailableList","AvailableListConstants"],function(a,b){a.subscribe(b.ON_AVAILABILITY_CHANGED,function(){return this.$4()}.bind(this))}.bind(this),"BaseChatSidebar.react");b("gkx")("678258")&&b("Bootloader").loadModules(["WorkChatSidebarUtils"],function(a){a.loadPinnedThreads(function(a){this.setState({pinnedThreads:a})}.bind(this))}.bind(this),"BaseChatSidebar.react")}.bind(this));b("ViewportBounds").addPersistentRight(l);b("Arbiter").inform("sidebar/initialized");b("ChatSidebarActions").init()};t.prototype.componentDidUpdate=function(a,b){b.computedState.visible!==this.state.computedState.visible&&this.handleVisibilityChange(this.state.computedState.visible);a=this.state.computedState.presencePrivacy.currentUser!==b.computedState.presencePrivacy.currentUser;this.state.computedState.enabled!==b.computedState.enabled&&s(this.state.computedState.enabled);a&&this.handleSizeUpdate()};t.prototype.setupStore=function(){b("ChatSidebarDerivedStore").getDependencyStores().forEach(function(a){b("ChatDispatcher").explicitlyRegisterStore(a)}),this.props.onRegisterStore&&this.props.onRegisterStore(function(){return this.adjustToFitHeight()}.bind(this)),b("ChatSidebarActions").loaded(),b("ChatSidebarDerivedStore").addListener(this.$5)};t.prototype.setupSettingHandler=function(){b("Arbiter").subscribe("chat/option-changed",function(a,b){a=b.name;(a==="hide_groups"||a==="hide_admined_pages"||a==="hide_businesses")&&this.adjustToFitHeight()}.bind(this)),b("Arbiter").subscribe(["AppsDivebar/show-apps","AppsDivebar/hide-apps","PagesDivebar/show-pages","PagesDivebar/hide-pages"],function(){return this.adjustToFitHeight()}.bind(this))};t.prototype.setupSearchHandler=function(){b("Arbiter").subscribe("sidebar/typeahead/active",this.updateOnActiveTypeahead),b("gkx")("678653")?b("onAfterDisplay")(this.bootloadKeyboardShortcuts.bind(this)):this.bootloadKeyboardShortcuts()};t.prototype.bootloadKeyboardShortcuts=function(){var a=this.props.root;b("Bootloader").loadModules(["KeyboardShortcuts"],function(c){c.register("q",function(c){if(this.$8()!==b("SidebarType").SIDEBAR)return;b("requireWeak")("ChatTypeaheadCore",function(b){b.focusSearchField(a,c)})}.bind(this),{persistOnTransition:!0})}.bind(this),"BaseChatSidebar.react")};t.prototype.render=function(){var a=this.state.computedState;return!a.enabled?null:b("React").createElement("div",{onMouseOver:this.handleMouserOver,onMouseOut:this.handleMouserOut},this.props.children({computedState:a,hide:!this.state.show,onMouseEnterItem:this.handleMouseEnterItem,pinnedThreads:this.state.pinnedThreads}))};t.prototype.handleVisibilityChange=function(a){switch(a){case b("SidebarType").SIDEBAR:this.show();break;case b("SidebarType").BUDDYLIST:this.hide();break}};t.prototype.adjustToFitHeight=function(){var a;b("queryThenMutateDOM")(function(){a=t.getBodyHeight(this.props.heightOffset)}.bind(this),function(){return this.adjustToFitHeightFromParams(a)}.bind(this))};t.prototype.adjustToFitHeightFromParams=function(a){if(!a)return;var c=Math.floor(a-j);this.$4(!0);this.$1&&b("Style").set(this.$1,"height",a+"px");b("Arbiter").inform("sidebar/resized",c,"state");b("Arbiter").inform("reflow")};t.prototype.resizeAndUpdateViewport=function(a){this.resize(a,function(){r=b("ChatSidebarVisibility").getViewport()})};t.prototype.show=function(){var a=document.documentElement||"";b("CSS").addClass(a,k);b("CSS").removeClass(a,q);p&&b("Bootloader").loadModules(["Dock"],function(a){a.resizeAllFlyouts()},"BaseChatSidebar.react");b("CSS").show(this.props.root);b("Arbiter").inform("sidebar/visibility",!0,"state");b("LitestandClassicPlaceHolders").destroy("sidebar");b("ViewportBounds").inform("change")};t.prototype.hide=function(){var a=document.documentElement||"";p&&!this.isOnHomepage()?b("CSS").addClass(a,q):(b("CSS").removeClass(a,q),p&&b("Bootloader").loadModules(["Dock"],function(a){a.resizeAllFlyouts()},"BaseChatSidebar.react"));b("CSS").removeClass(a,k);b("CSS").hide(this.props.root);b("Arbiter").inform("sidebar/visibility",!1,"state");b("Arbiter").inform("reflow");b("ViewportBounds").inform("change")};t.prototype.isOnHomepage=function(){return new(b("URI"))(window.location.href).getPath()==="/"};t.prototype.$8=function(){return b("ChatSidebarDerivedStore").getVisibleType()};t.prototype.shouldSidebarUpdate=function(){if(this.$8()!==b("SidebarType").SIDEBAR||this.$2){this.$2&&(this.$3=!0);return!1}return!0};t.prototype.handleSizeUpdate=function(){var a=t.calculateMaxItemSlots(this.props.heightOffset),c=this.state.computedState;this.setState({computedState:b("ChatSidebarDerivedStore").get(t.calculateMaxItemSlots(this.props.heightOffset))},function(){var d=this.state.computedState,e=d.adminedPages,f=d.isUserOffline,g=d.groups,h=d.nearby,i=d.numTopFriends;d=d.pymmList;if(f!==c.isUserOffline||i!==c.numTopFriends||g.length!==c.groups.length||h.length!==c.nearby.length||e.length!==c.adminedPages.length||((f=d)!=null?(f=f.pages)!=null?f.length:f:f)!==((f=c)!=null?(f=f.pymmList)!=null?(f=f.pages)!=null?f.length:f:f:f)){new(b("MessengerDivebarSizingTypedLogger"))().setMaxItemSlots(a).setSidebarType(b("SidebarType").SIDEBAR).setNumTopFriends(i).setNumNearby(h.length).setNumGroups(g.length).setNumAdminedPages(e.length).setNumPymm(((f=d)!=null?(f=f.pages)!=null?f.length:f:f)||0).log()}}.bind(this))};t.prototype.handleUsersUpdate=function(){var a=this.state.computedState.maxItemSlots;a=b("ChatSidebarDerivedStore").get(a);this.state.computedState!==a&&this.setState({computedState:a})};e.exports=t}),null);
__d("SRFunctionRef",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}e.exports=a}),null);
__d("ChatSidebar.react",["BaseChatSidebar.react","ChatSidebarOrderedList.react","React","SRFunctionRef"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("React").createElement(b("BaseChatSidebar.react"),{root:a.root,heightOffset:0},b("SRFunctionRef")(function(a){var c=a.computedState,d=a.hide;a=a.onMouseEnterItem;return b("React").createElement(b("ChatSidebarOrderedList.react"),{adminedPages:c.adminedPages,marketplaceThreads:c.marketplaceThreads,availableUsers:c.availableUsers,groups:c.groups,hide:d,isAfterDomLoad:c.isAfterDomLoad,isSidebar:!0,isUserOffline:c.isUserOffline,maxItemSlots:c.maxItemSlots+1,nearby:c.nearby,offlineUsers:c.offlineUsers,onMouseEnterItem:a,pageListModule:c.pageListModule,pymmList:c.pymmList,recentCalls:c.recentCalls,topUsers:c.topUsers,usersDetailedData:c.usersDetailedData,workOthers:c.workOthers})}))}e.exports=a}),null);
__d("ScriptPathState",["Arbiter"],(function(a,b,c,d,e,f){__p&&__p();var g,h,i,j,k=100,l={setIsUIPageletRequest:function(a){i=a},setUserURISampleRate:function(a){j=a},reset:function(){g=null,h=!1,i=!1},_shouldUpdateScriptPath:function(){return h&&!i},_shouldSendURI:function(){return Math.random()<j},getParams:function(){var a={};l._shouldUpdateScriptPath()?l._shouldSendURI()&&g!==null&&(a.user_uri=g.substring(0,k)):a.no_script_path=1;return a}};b("Arbiter").subscribe("pre_page_transition",function(a,b){h=!0,g=b.to.getUnqualifiedURI().toString()});e.exports=a.ScriptPathState=l}),null);
__d("goOrReplace",[],(function(a,b,c,d,e,f){function a(a,b,c){c?a.replace(b):a.href==b?a.reload():a.href=b}e.exports=a}),null);
__d("AjaxPipeRequest",["invariant","Arbiter","AsyncRequest","AsyncRequestConfig","BigPipe","ContextualComponent","CSS","DOM","Env","PageEvents","PageletGK","PageletSet","PageNavigationStageLogger","ScriptPathState","URI","containsNode","ge","goOrReplace","performance","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("PageletGK").destroyDomAfterEventHandler,i,j=0;function k(a,c){__p&&__p();var d=b("ge")(a);if(!d)return;c||(d.style.minHeight="100px");c=b("PageletSet").getPageletIDs();for(var e=0;e<c.length;e++){var f=c[e];if(b("PageletSet").hasPagelet(f)){var g=b("PageletSet").getPagelet(f);b("containsNode")(d,g.getRoot())&&b("PageletSet").removePagelet(f)}}b("Arbiter").inform(b("PageEvents").AJAXPIPE_ONBEFORECLEARCANVAS,{canvasID:a});function i(a){var c=b("ContextualComponent").forNode(a);c&&c.unmount();b("DOM").empty(a)}h?(b("Arbiter").inform("pagelet/destroy",{id:null,root:d}),i(d)):(i(d),b("Arbiter").inform("pagelet/destroy",{id:null,root:d}))}function l(a,c){a=b("ge")(a);a&&!c&&(a.style.minHeight="100px")}function c(a,c,d){"use strict";__p&&__p();this._allowIrrelevantRequests=!1;this._canvas_id=a;this._uri=c;this._query_data=d;a=new(b("AsyncRequest"))();a.disableInteractionServerTracing();a.setReplaceTransportMarkers(!1);this._request=a;this._allow_cross_page_transition=!0;this._arbiter=new(b("Arbiter"))();this._requestID=j++}c.prototype.getArbiter=function(){"use strict";return this._arbiter};c.prototype.setData=function(a){"use strict";this._query_data=a;return this};c.prototype.getData=function(){"use strict";return this._query_data};c.prototype.setAllowCrossPageTransition=function(a){"use strict";this._allow_cross_page_transition=a;return this};c.prototype.setAppend=function(a){"use strict";this._append=a;return this};c.prototype._getAsyncRequestType=function(){"use strict";return b("AsyncRequestConfig").useFetchStreamAjaxPipeTransport?"useFetchWithIframeFallback":"useIframeTransport"};c.prototype.send=function(){"use strict";__p&&__p();this._arbiter.inform(b("PageEvents").AJAXPIPE_SEND,{rid:this._requestID,quickling:!!this._isQuickling,ts:b("performanceAbsoluteNow")()},"persistent");var a={ajaxpipe:1,ajaxpipe_token:b("Env").ajaxpipe_token};Object.assign(a,b("ScriptPathState").getParams());b("ScriptPathState").reset();var c=this._request;if(c==null)return this;c.setOption(this._getAsyncRequestType(),!0).delayPreDisplayJS().setURI(this._uri).setData(Object.assign(a,this._query_data)).setPreBootloadHandler(this._preBootloadHandler.bind(this)).setInitialHandler(this._onInitialResponse.bind(this)).setHandler(this._onResponse.bind(this)).setMethod("GET").setReadOnly(!0).setAllowCrossPageTransition(this._allow_cross_page_transition).setAllowIrrelevantRequests(this._allowIrrelevantRequests);this._automatic?this._relevantRequest=i:i=this._request;if(this._isQuickling){a=b("performance").clearResourceTimings||b("performance").webkitClearResourceTimings;a&&a.call(b("performance"))}c.send();return this};c.prototype._preBootloadFirstResponse=function(a){"use strict";return!1};c.prototype._fireDomContentCallback=function(){"use strict";var a=this._request;a&&a.cavalry&&a.cavalry.setTimeStamp("t_domcontent");this._arbiter.inform(b("PageEvents").AJAXPIPE_DOMREADY,!0,"state")};c.prototype._fireOnloadCallback=function(){"use strict";window.console&&console.timeStamp&&console.timeStamp('perf_trace {"name": "e2e", "parent": "PageEvents.AJAXPIPE_ONLOAD"}');var a=this._request;a!=null&&a.cavalry&&(a.cavalry.setTimeStamp("t_hooks"),a.cavalry.setTimeStamp("t_layout"),a.cavalry.setTimeStamp("t_onload"));this._arbiter.inform(b("PageEvents").AJAXPIPE_ONLOAD,{lid:this.pipe.lid,rid:this._requestID,ts:b("performanceAbsoluteNow")()},"state")};c.prototype._isRelevant=function(a){"use strict";return this._request===i||this._automatic&&this._relevantRequest===i||this._jsNonBlock||i!=null&&i.getAllowIrrelevantRequests()};c.prototype._preBootloadHandler=function(a){"use strict";var c=this._request,d=a.getPayload();if(!d||d.redirect||!this._isRelevant(a))return!1;var e=!1;a.is_first&&(!this._append&&!this._displayCallback&&k(this._canvas_id,this._constHeight),e=this._preBootloadFirstResponse(a),c!=null||g(0,36),this.pipe=new(b("BigPipe"))({config:d.bigPipeConfig,arbiter:this._arbiter,rootNodeID:this._canvas_id,lid:c.lid,rid:this._requestID,isAjax:!0,domContentCallback:this._fireDomContentCallback.bind(this),onloadCallback:this._fireOnloadCallback.bind(this),domContentEvt:b("PageEvents").AJAXPIPE_DOMREADY,onloadEvt:b("PageEvents").AJAXPIPE_ONLOAD,jsNonBlock:this._jsNonBlock,automatic:this._automatic,displayCallback:this._displayCallback,allowIrrelevantRequests:this._allowIrrelevantRequests}),this.pipe.setPageID(c.lid));return e};c.prototype._redirect=function(c){"use strict";__p&&__p();if(c.redirect){if(c.force||!this.isPageActive(c.redirect)){var d=["ajaxpipe","ajaxpipe_token"].concat(this.getSanitizedParameters());b("PageNavigationStageLogger").setCookieForNavigation(c.redirect);b("PageNavigationStageLogger").setNote("ajaxpipe_redirect");b("PageNavigationStageLogger").updateCookie();b("goOrReplace")(window.location,new(b("URI"))(c.redirect).removeQueryData(d),!0)}else{d=a.PageTransitions;d.go(c.redirect,!0)}return!0}else return!1};c.prototype.isPageActive=function(a){"use strict";return!0};c.prototype.getSanitizedParameters=function(){"use strict";return[]};c.prototype._versionCheck=function(a){"use strict";return!0};c.prototype._onInitialResponse=function(a){"use strict";var b=a.getPayload();if(!this._isRelevant(a))return!1;if(!b)return!0;return this._redirect(b)||!this._versionCheck(b)?!1:!0};c.prototype._processFirstResponse=function(a){"use strict";this._arbiter.inform(b("PageEvents").AJAXPIPE_FIRST_RESPONSE,{lid:this.pipe.lid,quickling:!!this._isQuickling});a=a.getPayload();var c=b("ge")(this._canvas_id);a=a.canvas_class;c!=null&&a!=null&&b("CSS").setClass(c,a)};c.prototype.setFirstResponseCallback=function(a){"use strict";this._firstResponseCallback=a;return this};c.prototype.setFirstResponseHandler=function(a){"use strict";this._processFirstResponse=a;return this};c.prototype._onResponse=function(a){"use strict";__p&&__p();var c=a.payload;if(!this._isRelevant(a))return b("AsyncRequest").suppressOnloadToken;a.is_first&&(this._processFirstResponse(a),this._firstResponseCallback&&this._firstResponseCallback(),c.provides=c.provides||[],c.provides.push("uipage_onload"));if(c){if("content"in c.content){this._append&&(c.append=this._canvas_id);var d=c.content.content;delete c.content.content;c.content[this._canvas_id]=d}this.pipe.onPageletArrive(c)}a.is_last&&l(this._canvas_id,this._constHeight);return b("AsyncRequest").suppressOnloadToken};c.prototype.setNectarModuleDataSafe=function(a){"use strict";this._request!=null&&this._request.setNectarModuleDataSafe(a);return this};c.prototype.setFinallyHandler=function(a){"use strict";this._request!=null&&this._request.setFinallyHandler(a);return this};c.prototype.setErrorHandler=function(a){"use strict";this._request!=null&&this._request.setErrorHandler(a);return this};c.prototype.setTransportErrorHandler=function(a){"use strict";this._request!=null&&this._request.setTransportErrorHandler(a);return this};c.prototype.setResetHandler=function(a){"use strict";this._resetHandler=a;return this};c.prototype.abort=function(){"use strict";this._request!=null&&this._request.abort();this._reset();return this};c.prototype.abandon=function(){"use strict";this._request!=null&&this._request.abandon();this._reset();return this};c.prototype._reset=function(){"use strict";i==this._request&&(i=null),this._request=null,this._resetHandler&&this._resetHandler()};c.prototype.setJSNonBlock=function(a){"use strict";this._jsNonBlock=a;return this};c.prototype.setAutomatic=function(a){"use strict";this._automatic=a;return this};c.prototype.setDisplayCallback=function(a){"use strict";this._displayCallback=a;return this};c.prototype.setConstHeight=function(a){"use strict";this._constHeight=a;return this};c.prototype.setAllowIrrelevantRequests=function(a){"use strict";this._allowIrrelevantRequests=a;return this};c.prototype.getAsyncRequest=function(){"use strict";return this._request};c.getCurrentRequest=function(){"use strict";return i};c.setCurrentRequest=function(a){"use strict";i=a};c.clearCanvas=k;e.exports=c}),null);
__d("UIPageletContentCache",[],(function(a,b,c,d,e,f){a={cache:{},getContent:function(a){return a in this.cache?this.cache[a]:null},setContent:function(a,b){this.cache[a]=b}};e.exports=a}),null);
__d("UIPagelet",["ActorURI","AjaxPipeRequest","AsyncRequest","DOM","HTML","ScriptPathState","UIPageletContentCache","URI","emptyFunction","ge","isElementNode"],(function(a,b,c,d,e,f){__p&&__p();function g(a,c,d){"use strict";__p&&__p();var e=a&&b("isElementNode")(a)?a.id:a;this._id=e||null;this._element=b("ge")(a||b("DOM").create("div"));this._src=c||null;this._context_data=d||{};this._data={};this._handler=b("emptyFunction");this._request=null;this._use_ajaxpipe=!1;this._use_post_request=!1;this._is_bundle=!0;this._allow_cross_page_transition=!1;this._append=!1;this._cache_content=!1;this._content_cache_key="";this._is_content_cached=null}g.prototype.getElement=function(){"use strict";return this._element};g.prototype.setHandler=function(a){"use strict";this._handler=a;return this};g.prototype.go=function(a,b){"use strict";arguments.length>=2||typeof a==="string"?(this._src=a,this._data=b||{}):arguments.length==1&&(this._data=a);this.refresh();return this};g.prototype.setAllowCrossPageTransition=function(a){"use strict";this._allow_cross_page_transition=a;return this};g.prototype.setBundleOption=function(a){"use strict";this._is_bundle=a;return this};g.prototype.setErrorHandler=function(a){"use strict";this._errorHandler=a;return this};g.prototype.setTransportErrorHandler=function(a){"use strict";this.transportErrorHandler=a;return this};g.prototype.refresh=function(){"use strict";__p&&__p();if(this._use_ajaxpipe)b("ScriptPathState").setIsUIPageletRequest(!0),this._request=new(b("AjaxPipeRequest"))(this._id,this._src),this._request.setAppend(this._append).setConstHeight(this._constHeight).setJSNonBlock(this._jsNonblock).setAutomatic(this._automatic).setDisplayCallback(this._displayCallback).setFinallyHandler(this._finallyHandler),this._errorHandler&&this._request.setErrorHandler(this._errorHandler),this.transportErrorHandler&&this._request.setTransportErrorHandler(this.transportErrorHandler),this._allowIrrelevantRequests!=null&&this._request.setAllowIrrelevantRequests(this._allowIrrelevantRequests);else{if(this._cache_content){var a=b("UIPageletContentCache").getContent(this._content_cache_key);if(a!==null){this.handleContent(a,!0);return this}}var c=function(a){this._request=null;a=b("HTML")(a.getPayload());this.handleContent(a);var c=a.getContent().contains("<iframe");!c&&this._cache_content&&b("UIPageletContentCache").setContent(this._content_cache_key,a)}.bind(this),d=this._displayCallback,e=this._finallyHandler;this._request=new(b("AsyncRequest"))(this._src).setMethod("GET").setReadOnly(!0).setOption("bundle",this._is_bundle).setHandler(function(a){d?d(c.bind(null,a)):c(a),e&&e(a)});this._errorHandler&&this._request.setErrorHandler(this._errorHandler);this.transportErrorHandler&&this._request.setTransportErrorHandler(this.transportErrorHandler);this._use_post_request&&this._request.setMethod("POST")}a=babelHelpers["extends"]({},this._context_data,this._data);this._actorID&&(a[b("ActorURI").PARAMETER_ACTOR]=this._actorID);this._request.setAllowCrossPageTransition(this._allow_cross_page_transition).setData({data:JSON.stringify(a)}).send();return this};g.prototype.handleContent=function(a,c){"use strict";this._append?b("DOM").appendContent(this._element,a):b("DOM").setContent(this._element,a),c?(this._is_content_cached=!0,this._displayCallback(b("emptyFunction"))):this._is_content_cached=!1,this._handler()};g.prototype.cancel=function(){"use strict";this._request&&this._request.abort()};g.prototype.abandon=function(){"use strict";this._request&&this._request.abandon()};g.prototype.setUseAjaxPipe=function(a){"use strict";this._use_ajaxpipe=!!a;return this};g.prototype.setUsePostRequest=function(a){"use strict";this._use_post_request=!!a;return this};g.prototype.setAppend=function(a){"use strict";this._append=!!a;return this};g.prototype.setJSNonBlock=function(a){"use strict";this._jsNonblock=!!a;return this};g.prototype.setAutomatic=function(a){"use strict";this._automatic=!!a;return this};g.prototype.setDisplayCallback=function(a){"use strict";this._displayCallback=a;return this};g.prototype.setConstHeight=function(a){"use strict";this._constHeight=!!a;return this};g.prototype.setFinallyHandler=function(a){"use strict";this._finallyHandler=a;return this};g.prototype.setAllowIrrelevantRequests=function(a){"use strict";this._allowIrrelevantRequests=a;return this};g.prototype.setActorID=function(a){"use strict";this._actorID=a;return this};g.prototype.setCacheContent=function(a){"use strict";this._cache_content=a;return this};g.prototype.setContentCacheKey=function(a){"use strict";this._content_cache_key=a;return this};g.prototype.isContentCached=function(){"use strict";return this._is_content_cached};g.appendToInline=function(a,c){"use strict";a=b("ge")(a);c=b("ge")(c);if(a&&c){while(c.firstChild)b("DOM").appendContent(a,c.firstChild);b("DOM").remove(c)}};g.loadFromEndpoint=function(a,c,d,e){"use strict";__p&&__p();e=e||{};var f="/ajax/pagelet/generic.php/"+a;e.intern&&(f="/intern"+f);e.query&&(f=f+"?"+e.query);f=new(b("URI"))(f.replace(/\/+/g,"/"));e.subdomain&&f.setSubdomain(e.subdomain);var h=!1,i="";e.contentCacheKey&&(h=!0,i=a+","+String(e.contentCacheKey));a=new g(c,f,d).setUseAjaxPipe(e.usePipe).setBundleOption(e.bundle!==!1).setAppend(e.append).setJSNonBlock(e.jsNonblock).setAutomatic(e.automatic).setDisplayCallback(e.displayCallback).setConstHeight(e.constHeight).setAllowCrossPageTransition(e.crossPage).setFinallyHandler(e.finallyHandler||b("emptyFunction")).setErrorHandler(e.errorHandler).setTransportErrorHandler(e.transportErrorHandler).setAllowIrrelevantRequests(e.allowIrrelevantRequests).setActorID(e.actorID).setCacheContent(h).setContentCacheKey(i).setUsePostRequest(e.usePostRequest);e.handler&&a.setHandler(e.handler);a.go();return a};g.loadFromEndpointBatched=function(a,c,d){"use strict";__p&&__p();var e=a.slice(0,d),f=a.slice(d);if(f.length>0){a=e[e.length-1];var h=b("emptyFunction");a.options&&a.options.finallyHandler&&(h=a.options.finallyHandler);a.options=babelHelpers["extends"]({},a.options,{finallyHandler:function(){h(),window.setTimeout(function(){g.loadFromEndpointBatched(f,c,d)},1)}})}e.forEach(function(a){g.loadFromEndpoint(a.controller,a.target_element,a.data,babelHelpers["extends"]({},a.options,c,{bundle:!0}))})};e.exports=g}),null);
__d("XPageAdminHomePagePanelSaveSettingsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/pages/homepage_panel/save_settings/",{selected_id:{type:"FBID"},collapse_state:{type:"Int"},refresh_panel:{type:"Bool",defaultValue:!1},click_target:{type:"String"}})}),null);
__d("PageHomepagePanelPagelet",["AsyncRequest","DOM","UIPagelet","URI","XPageAdminHomePagePanelSaveSettingsController","$"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="homepage_panel_pagelet_content";a={init:function(a){var c=b("XPageAdminHomePagePanelSaveSettingsController").getURIBuilder().setBool("refresh_panel",!0).getURI();c.addQueryData(b("URI").getRequestURI().getQueryData());new(b("AsyncRequest"))().setURI(c).setStatusElement(a).setErrorHandler(function(a){b("DOM").setContent(b("$")(g),"")}).send()},initWithAjax:function(){b("UIPagelet").loadFromEndpoint("PageHomepagePanelPagelet",g,{content_only:!0},{usePipe:!0,allowIrrelevantRequests:!0,displayCallback:function(a){return a()}})}};e.exports=a}),null);